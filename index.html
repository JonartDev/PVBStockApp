<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ğŸŒ¾ PVB Live Stock Updates</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#2a9d8f">

    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(() => console.log('âœ… Service Worker registered'))
                .catch(err => console.error('âŒ Service Worker failed', err));
        }

        // âœ… PWA install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installBtn').style.display = 'block';
        });

        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(() => {
                    deferredPrompt = null;
                    document.getElementById('installBtn').style.display = 'none';
                });
            }
        }
    </script>
</head>

<body>
    <h1>
        ğŸŒ¾ PVB Live Stock Updates
        <button id="refreshBtn" class="refresh-top-btn" title="Refresh Data">ğŸ”„</button>
    </h1>

    <div id="loading" class="loading">Loading data...</div>
    <div id="stockData" class="stock-container"></div>
    <div id="timeDisplay"></div>
    <div id="timer"></div>

    <!-- ğŸ›‘ Stop + âš™ï¸ Settings + ğŸ“² Install Buttons -->
    <button id="stopSoundBtn">ğŸ›‘ Stop Sound</button>

    <button id="settingsBtn">âš™ï¸</button>

    <button id="installBtn">
        ğŸ“² Install App
    </button>

    <!-- âš™ï¸ Settings Modal -->
    <div id="settingsModal" class="modal-overlay" style="display:none;">
        <div id="settingsContent" class="modal-content">
            <h2>ğŸ”” Notification Settings</h2>

            <div class="tab">
                <button id="tabSeeds" class="active" onclick="switchTab('seeds')">ğŸŒ± Seeds</button>
                <button id="tabGears" onclick="switchTab('gears')">âš™ï¸ Gears</button>
            </div>

            <div id="seedSettings"></div>
            <div id="gearSettings" style="display:none;"></div>

            <div class="modal-buttons">
                <button class="btn-save" onclick="saveSettings()">ğŸ’¾ Save</button>
                <button class="btn-close" onclick="closeSettings()">âŒ Close</button>
            </div>
        </div>
    </div>

    <!-- ğŸ”” Floating Notification Popup -->
    <div id="popupNotification" class="notification-popup">
        <div class="popup-icon">ğŸ””</div>
        <div class="popup-content" id="popupMessage">New update detected!</div>
        <button class="popup-close" onclick="hidePopup()">âœ–</button>
    </div>

    <script src="./script.js"></script>
</body>


</html>